<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rilascia IPR — HERMETICUM B.C.E.</title>
  <meta name="description" content="Rilascio guidato di un IPR (Identity Primary Record): comprendi il perimetro, genera il record, verifica l’esito.">
  <style>
    body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;background:#0b0b0b;color:#e6e6e6;line-height:1.6}
    header,section{max-width:1100px;margin:auto;padding:2.5rem 1rem}
    header{padding-top:3.5rem}
    h1{font-size:2.2rem;margin:0 0 .5rem}
    h2{margin-top:0}
    .sub{opacity:.85}
    .badge{display:inline-block;border:1px solid #444;border-radius:999px;padding:.15rem .6rem;font-size:.85rem;opacity:.9}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1.2rem;margin-top:1.5rem}
    .card{border:1px solid #222;background:#111;border-radius:6px;padding:1.25rem}
    .cta{display:inline-block;margin:.5rem .4rem 0 0;padding:.7rem 1.1rem;border:1px solid #444;border-radius:4px;color:#fff;text-decoration:none;font-weight:500}
    .cta.primary{border-color:#888}
    ul{margin-top:.5rem}
    .warn{opacity:.9}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    textarea,input{width:100%;background:#0f0f0f;color:#e6e6e6;border:1px solid #222;border-radius:6px;padding:10px;box-sizing:border-box}
    label{display:block;margin:.75rem 0 .25rem;opacity:.9}
    button{background:#111;color:#fff;border:1px solid #444;border-radius:4px;padding:.7rem 1.1rem;cursor:pointer;font-weight:600}
    button.primary{border-color:#888}
    .row{display:flex;gap:.6rem;flex-wrap:wrap;margin-top:.75rem}
    .line{height:1px;background:#222;margin:1.2rem 0}
    .hint{opacity:.85;font-size:.95rem}
  </style>
</head>

<body>

<header>
  <div class="badge">Create / IPR</div>
  <h1>Rilascia un IPR</h1>
  <p class="sub">
    Stai creando un <strong>IPR (Identity Primary Record)</strong>: un record tecnico di origine
    verificabile per integrità, audit e continuità operativa.
  </p>

  <div style="margin-top:1rem;">
    <a class="cta" href="../citizen/">Citizen</a>
    <a class="cta" href="../professional/">Professional</a>
    <a class="cta" href="../verify/">Verifica</a>
    <a class="cta" href="../">Home</a>
  </div>
</header>

<section>
  <h2>Prima di procedere</h2>
  <div class="grid">
    <div class="card">
      <h3>Cosa stai facendo</h3>
      <p>
        Crei una <strong>radice tecnica</strong> (manifest + hash) che descrive l’origine di un contenuto
        o di un insieme di dati.
      </p>
    </div>
    <div class="card">
      <h3>Cosa NON stai facendo</h3>
      <ul>
        <li>Identità legale</li>
        <li>Firma elettronica qualificata</li>
        <li>Accesso a servizi pubblici</li>
      </ul>
    </div>
    <div class="card">
      <h3>Regola chiave</h3>
      <p class="warn">
        La fiducia nasce dalla <strong>verifica</strong>, non dalla creazione.
        In caso di dubbio → <strong>fail-closed</strong>.
      </p>
    </div>
  </div>
</section>

<section>
  <h2>Processo di rilascio (5 step)</h2>
  <div class="grid">
    <div class="card"><strong>1)</strong> Selezione contenuto</div>
    <div class="card"><strong>2)</strong> Generazione hash</div>
    <div class="card"><strong>3)</strong> Creazione manifest</div>
    <div class="card"><strong>4)</strong> (Opzionale) ancoraggio temporale</div>
    <div class="card"><strong>5)</strong> Output IPR e verifica</div>
  </div>
</section>

<section>
  <h2>Dati di input (minimi)</h2>
  <div class="card">
    <label for="title">Titolo / riferimento</label>
    <input id="title" placeholder="Esempio: Documento tecnico v1.0">

    <label for="description">Descrizione (facoltativa)</label>
    <textarea id="description" placeholder="Descrizione sintetica del contenuto..."></textarea>

    <label for="content">Contenuto di riferimento</label>
    <textarea id="content" placeholder="Testo, hash esterno, riferimento a file, ecc."></textarea>

    <div class="line"></div>

    <p class="hint">
      Usa solo dati che sei autorizzato a trattare. Vedi <a href="../terms/">Termini</a>.
    </p>

    <div class="row">
      <button class="primary" id="releaseBtn">Rilascia IPR</button>
      <a class="cta" href="success.html">Output IPR</a>
    </div>
  </div>
</section>

<section>
  <h2>Cosa ottieni</h2>
  <div class="grid">
    <div class="card">
      <ul>
        <li>Manifest IPR (scaricabile)</li>
        <li>Hash verificabili</li>
        <li>Riferimento temporale locale</li>
      </ul>
    </div>
    <div class="card">
      <p class="warn">
        Sei responsabile della <strong>conservazione</strong>.
        Senza conservazione non esiste continuità operativa.
      </p>
    </div>
    <div class="card">
      <p>
        Prossimo passo:
        <a class="cta primary" href="../verify/">Verifica IPR</a>
      </p>
    </div>
  </div>
</section>

<footer style="margin-top:4rem;padding:2rem 1rem;border-top:1px solid #222;font-size:0.9rem;opacity:0.85;">
  <div style="max-width:1100px;margin:auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:1rem;">
    <div>
      <strong>HERMETICUM B.C.E.</strong><br>
      HERMETICUM - BLINDATA · COMPUTABILE · EVOLUTIVA<br>
      <span class="sub">HERMETICUM B.C.E. S.r.l.</span>
    </div>
    <div>
      <a href="../legal/privacy.html">Privacy</a><br>
      <a href="../legal/cookies.html">Cookies</a><br>
      <a href="../legal/accessibility.html">Accessibility</a>
    </div>
    <div>
      <a href="../legal/legal-notice.html">Legal notice</a><br>
      <a href="../legal/contact.html">Contact</a>
    </div>
    <div>
      Platform status: <strong>Experimental</strong><br>
      Jurisdiction: <strong>EU</strong>
    </div>
  </div>
</footer>

<script>
  function sha256(str) {
    const enc = new TextEncoder();
    return crypto.subtle.digest('SHA-256', enc.encode(str)).then(buf =>
      Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2, '0')).join('')
    );
  }

  async function releaseIPR() {
    const title = document.getElementById('title').value.trim();
    const description = document.getElementById('description').value.trim();
    const content = document.getElementById('content').value.trim();

    if (!title || !content) {
      alert("Titolo e contenuto sono obbligatori.");
      return;
    }

    const hash = await sha256(content);

    const manifest = {
      schema: "HBCE-IPR-1",
      title,
      description,
      hash_sha256: hash,
      released_at: new Date().toISOString(),
      jurisdiction: "EU",
      status: "experimental"
    };

    const manifestText = JSON.stringify(manifest, null, 2);

    localStorage.setItem("hbce_ipr_manifest", manifestText);
    localStorage.setItem("hbce_ipr_released_at", manifest.released_at);

    window.location.href = "success.html";
  }

  document.getElementById('releaseBtn').addEventListener('click', releaseIPR);
</script>

</body>
</html>
