<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OpenAPI — IPR Precheck (ex-ante)</title>
  <meta name="description" content="Specifica OpenAPI per il precheck ex-ante (fail-closed) basato su Identity Primary Record (IPR)." />
  <link rel="stylesheet" href="../assets/style.css" />
</head>

<body>
  <header class="topbar">
    <div class="container">
      <a class="brand" href="../index.html">HERMETICUM B.C.E.</a>
      <nav class="nav">
        <a href="../ipr/index.html">IPR</a>
        <a href="../verify/index.html">Verify</a>
        <a href="../gate/index.html">Gate</a>
        <a href="../datacenter/index.html">DataCenter</a>
        <a class="active" href="./index.html">OpenAPI</a>
        <a href="../use-cases/index.html">Use Cases</a>
        <a href="../status/index.html">Status</a>
        <a href="../governance/index.html">Governance</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <h1>OpenAPI</h1>

    <p class="lead">
      Questo endpoint va chiamato <strong>prima</strong> di ogni azione critica.
      Se non esiste prova verificabile ex-ante → <strong>FAIL</strong> (fail-closed).
    </p>

    <section class="card">
      <h2>Schema operativo (mini)</h2>
      <pre class="code">Azione proposta -> POST /precheck -> PASS (esegui) | FAIL (blocca)
FAIL sempre in assenza di prova verificabile ex-ante</pre>
    </section>

    <section class="card">
      <h2>Endpoint minimo</h2>
      <p><code>POST /precheck</code></p>

      <h3>Esempio request</h3>
      <pre class="code">{
  "action_hash": "sha256:abcdef123456",
  "ipr_ref": "IPR-UE:xxxxxxxxxxxxxxxxxxxxxxxx",
  "timestamp": "2026-02-04T16:41:12+01:00"
}</pre>

      <h3>Esempio response (FAIL)</h3>
      <pre class="code">{
  "status": "FAIL",
  "reason_code": "IPR_NOT_VERIFIABLE",
  "mode": "fail-closed"
}</pre>

      <h3>Esempio response (PASS)</h3>
      <pre class="code">{
  "status": "PASS",
  "evidence_hash": "sha256:...",
  "mode": "fail-closed"
}</pre>
    </section>

    <section class="card">
      <h2>Specifica OpenAPI (YAML)</h2>
      <ul>
        <li>
          YAML (raw):
          <a href="https://raw.githubusercontent.com/manuelcoletta1-source/ipr-precheck-api/main/openapi.yaml" target="_blank" rel="noopener">
            openapi.yaml
          </a>
        </li>
        <li>
          Repo:
          <a href="https://github.com/manuelcoletta1-source/ipr-precheck-api" target="_blank" rel="noopener">
            ipr-precheck-api
          </a>
        </li>
      </ul>
      <p class="hint">
        Il portale espone la spec. L’esecuzione è condizionata dall’IPR (ex-ante).
      </p>
    </section>

  </main>

  <footer class="footer">
    <div class="container">
      <p>Non cambio chi decide. Cambio quando un’azione è ammessa.</p>
    </div>
  </footer>
</body>
</html>
